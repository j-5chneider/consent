graph [layout = dot, rankdir = LR, ranksep=3.0, nodesep=0.6]
# Knotenstil: manifeste Variablen
node [shape=rectangle, style=filled, fillcolor=White]
# Manifeste Prädiktoren
Exp_Participant [label = 'Experience as\\nResearch Participant']
Exp_Conducting [label = 'Experience Conducting\\nStudies']
# Manifeste AV
DwellTime [label = 'Dwell Time']
# Latente Variablen (andere Form)
node [shape=ellipse, style=filled, fillcolor=White]
# Latente Prädiktoren
Trust [label = 'Perceived Trust\\n(Benevolence)']
Risk [label = 'Perceived Risk\\nof Participation']
# Latente AVs
ReadingEngagement [label = 'Reading\\nEngagement']
Understanding [label = 'Understanding']
{rank=same; Exp_Participant; Exp_Conducting; Trust; Risk}
{rank=same; DwellTime; ReadingEngagement}
{rank=same; Understanding}
# Kanten: Jeder Prädiktor auf jede AV
Exp_Participant:e -> DwellTime:w
Exp_Participant:e -> ReadingEngagement:w
Exp_Conducting:e -> DwellTime:w
Exp_Conducting:e -> ReadingEngagement:w
Trust:e -> DwellTime:w
Trust:e -> ReadingEngagement:w
Risk:e -> DwellTime:w
Risk:e -> ReadingEngagement:w
DwellTime:e -> Understanding:w
ReadingEngagement:e -> Understanding:w
# Korrelationen (bidirektionale Pfeile) zwischen den AVs
edge [dir=both]
ReadingEngagement:s -> DwellTime:n
}
")
grViz("
digraph MANOVA {
graph [layout = dot, rankdir = LR, ranksep=3.0, nodesep=0.6]
# Knotenstil: manifeste Variablen
node [shape=rectangle, style=filled, fillcolor=White]
# Manifeste Prädiktoren
Exp_Participant [label = 'Experience as\\nResearch Participant']
Exp_Conducting [label = 'Experience Conducting\\nStudies']
# Manifeste AV
DwellTime [label = 'Dwell Time']
# Latente Variablen (andere Form)
node [shape=ellipse, style=filled, fillcolor=White]
# Latente Prädiktoren
Trust [label = 'Perceived Trust\\n(Benevolence)']
Risk [label = 'Perceived Risk\\nof Participation']
# Latente AVs
ReadingEngagement [label = 'Reading\\nEngagement']
Understanding [label = 'Understanding']
{rank=same; Exp_Participant; Exp_Conducting; Trust; Risk}
{rank=same; DwellTime; ReadingEngagement}
{rank=same; Understanding}
# Kanten: Jeder Prädiktor auf jede AV
Exp_Participant:e -> DwellTime:w
Exp_Participant:e -> ReadingEngagement:w
Exp_Conducting:e -> DwellTime:w
Exp_Conducting:e -> ReadingEngagement:w
Trust:e -> DwellTime:w
Trust:e -> ReadingEngagement:w
Risk:e -> DwellTime:w
Risk:e -> ReadingEngagement:w
DwellTime:e -> Understanding:w
ReadingEngagement:e -> Understanding:w
# Korrelationen (bidirektionale Pfeile) zwischen den AVs
edge [dir=both]
DwellTime:n -> ReadingEngagement:s
ReadingEngagement:s -> DwellTime:n
}
")
grViz("
digraph MANOVA {
graph [layout = dot, rankdir = LR, ranksep=3.0, nodesep=0.6]
# Knotenstil: manifeste Variablen
node [shape=rectangle, style=filled, fillcolor=White]
# Manifeste Prädiktoren
Exp_Participant [label = 'Experience as\\nResearch Participant']
Exp_Conducting [label = 'Experience Conducting\\nStudies']
# Manifeste AV
DwellTime [label = 'Dwell Time']
# Latente Variablen (andere Form)
node [shape=ellipse, style=filled, fillcolor=White]
# Latente Prädiktoren
Trust [label = 'Perceived Trust\\n(Benevolence)']
Risk [label = 'Perceived Risk\\nof Participation']
# Latente AVs
ReadingEngagement [label = 'Reading\\nEngagement']
Understanding [label = 'Understanding']
{rank=same; Exp_Participant; Exp_Conducting; Trust; Risk}
{rank=same; DwellTime; ReadingEngagement}
{rank=same; Understanding}
# Kanten: Jeder Prädiktor auf jede AV
Exp_Participant:e -> DwellTime:w
Exp_Participant:e -> ReadingEngagement:w
Exp_Conducting:e -> DwellTime:w
Exp_Conducting:e -> ReadingEngagement:w
Trust:e -> DwellTime:w
Trust:e -> ReadingEngagement:w
Risk:e -> DwellTime:w
Risk:e -> ReadingEngagement:w
DwellTime:e -> Understanding:w
ReadingEngagement:e -> Understanding:w
# Korrelationen (bidirektionale Pfeile) zwischen den AVs
edge [dir=both]
DwellTime:w -> ReadingEngagement:w
ReadingEngagement:s -> DwellTime:n
}
")
grViz("
digraph MANOVA {
graph [layout = dot, rankdir = LR, ranksep=3.0, nodesep=0.6]
# Knotenstil: manifeste Variablen
node [shape=rectangle, style=filled, fillcolor=White]
# Manifeste Prädiktoren
Exp_Participant [label = 'Experience as\\nResearch Participant']
Exp_Conducting [label = 'Experience Conducting\\nStudies']
# Manifeste AV
DwellTime [label = 'Dwell Time']
# Latente Variablen (andere Form)
node [shape=ellipse, style=filled, fillcolor=White]
# Latente Prädiktoren
Trust [label = 'Perceived Trust\\n(Benevolence)']
Risk [label = 'Perceived Risk\\nof Participation']
# Latente AVs
ReadingEngagement [label = 'Reading\\nEngagement']
Understanding [label = 'Understanding']
{rank=same; Exp_Participant; Exp_Conducting; Trust; Risk}
{rank=same; DwellTime; ReadingEngagement}
{rank=same; Understanding}
# Kanten: Jeder Prädiktor auf jede AV
Exp_Participant:e -> DwellTime:w
Exp_Participant:e -> ReadingEngagement:w
Exp_Conducting:e -> DwellTime:w
Exp_Conducting:e -> ReadingEngagement:w
Trust:e -> DwellTime:w
Trust:e -> ReadingEngagement:w
Risk:e -> DwellTime:w
Risk:e -> ReadingEngagement:w
DwellTime:e -> Understanding:w
ReadingEngagement:e -> Understanding:w
# Korrelationen (bidirektionale Pfeile) zwischen den AVs
edge [dir=both]
DwellTime:e -> ReadingEngagement:e
ReadingEngagement:s -> DwellTime:n
}
")
grViz("
digraph MANOVA {
graph [layout = dot, rankdir = LR, ranksep=3.0, nodesep=0.6]
# Knotenstil: manifeste Variablen
node [shape=rectangle, style=filled, fillcolor=White]
# Manifeste Prädiktoren
Exp_Participant [label = 'Experience as\\nResearch Participant']
Exp_Conducting [label = 'Experience Conducting\\nStudies']
# Manifeste AV
DwellTime [label = 'Dwell Time']
# Latente Variablen (andere Form)
node [shape=ellipse, style=filled, fillcolor=White]
# Latente Prädiktoren
Trust [label = 'Perceived Trust\\n(Benevolence)']
Risk [label = 'Perceived Risk\\nof Participation']
# Latente AVs
ReadingEngagement [label = 'Reading\\nEngagement']
Understanding [label = 'Understanding']
{rank=same; Exp_Participant; Exp_Conducting; Trust; Risk}
{rank=same; DwellTime; ReadingEngagement}
{rank=same; Understanding}
# Kanten: Jeder Prädiktor auf jede AV
Exp_Participant:e -> DwellTime:w
Exp_Participant:e -> ReadingEngagement:w
Exp_Conducting:e -> DwellTime:w
Exp_Conducting:e -> ReadingEngagement:w
Trust:e -> DwellTime:w
Trust:e -> ReadingEngagement:w
Risk:e -> DwellTime:w
Risk:e -> ReadingEngagement:w
DwellTime:e -> Understanding:w
ReadingEngagement:e -> Understanding:w
# Korrelationen (bidirektionale Pfeile) zwischen den AVs
edge [dir=both]
DwellTime:n -> ReadingEngagement:s
ReadingEngagement:s -> DwellTime:n
}
")
grViz("
digraph MANOVA {
graph [layout = dot, rankdir = LR, ranksep=3.0, nodesep=0.6]
# Knotenstil: manifeste Variablen
node [shape=rectangle, style=filled, fillcolor=White]
# Manifeste Prädiktoren
Exp_Participant [label = 'Experience as\\nResearch Participant']
Exp_Conducting [label = 'Experience\\nConducting Studies']
# Manifeste AV
DwellTime [label = 'Dwell Time']
# Latente Variablen (andere Form)
node [shape=ellipse, style=filled, fillcolor=White]
# Latente Prädiktoren
Trust [label = 'Perceived Trust\\n(Benevolence)']
Risk [label = 'Perceived Risk\\nof Participation']
# Latente AVs
ReadingEngagement [label = 'Reading\\nEngagement']
Understanding [label = 'Understanding']
{rank=same; Exp_Participant; Exp_Conducting; Trust; Risk}
{rank=same; DwellTime; ReadingEngagement}
{rank=same; Understanding}
# Kanten: Jeder Prädiktor auf jede AV
Exp_Participant:e -> DwellTime:w
Exp_Participant:e -> ReadingEngagement:w
Exp_Conducting:e -> DwellTime:w
Exp_Conducting:e -> ReadingEngagement:w
Trust:e -> DwellTime:w
Trust:e -> ReadingEngagement:w
Risk:e -> DwellTime:w
Risk:e -> ReadingEngagement:w
DwellTime:e -> Understanding:w
ReadingEngagement:e -> Understanding:w
# Korrelationen (bidirektionale Pfeile) zwischen den AVs
edge [dir=both]
DwellTime:n -> ReadingEngagement:s
ReadingEngagement:s -> DwellTime:n
}
")
library(brms)
library(dplyr)
# Posterior-Samples für Pfade ziehen
posterior <- as_draws_df(fit_mediation)
set.seed(123)
n <- 50  # gewünschte Stichprobengröße
# Plausible Mittelwerte / Standardabweichungen
experience_participant <- rnorm(n, 0, 1)
experience_conducting <- rnorm(n, 0, 1)
trust_benevolence <- rnorm(n, 0, 1)
perceived_risk <- rnorm(n, 0, 1)
# Mediatoren simulieren (Dummy-Effekte als Beispiel)
dwell_time <- rgamma(n, shape = 2, scale = exp(
0.1*experience_participant + 0.05*experience_conducting - 0.1*trust_benevolence + 0.1*perceived_risk
))
reading_engagement <- rnorm(n, mean = 50 -
2*experience_participant - 1.5*experience_conducting - 2*trust_benevolence + 2*perceived_risk, sd = 10)
# Outcome simulieren
understanding <- rnorm(n, mean = 80 -
1*dwell_time - 0.5*reading_engagement +
1*experience_participant - 0.5*trust_benevolence + 0.5*perceived_risk, sd = 15)
mydata <- data.frame(
experience_participant,
experience_conducting,
trust_benevolence,
perceived_risk,
dwell_time,
reading_engagement,
understanding
)
library(brms)
fit_mediation <- brm(
data = mydata,
formula =
bf(dwell_time ~ experience_participant + experience_conducting + trust_benevolence + perceived_risk,
family = Gamma(link = "log")) +
bf(reading_engagement ~ experience_participant + experience_conducting + trust_benevolence + perceived_risk,
family = student()) +
bf(understanding ~ experience_participant + experience_conducting + trust_benevolence + perceived_risk +
dwell_time + reading_engagement,
family = student()) +
set_rescor(TRUE),
chains = 2, iter = 2000, cores = 2, control = list(adapt_delta = 0.95)
)
fit_mediation <- brm(
data = mydata,
formula =
bf(dwell_time ~ experience_participant + experience_conducting + trust_benevolence + perceived_risk,
family = student()) + # has to be student, as otherwise residual correlations will not be estimated
bf(reading_engagement ~ experience_participant + experience_conducting + trust_benevolence + perceived_risk,
family = student()) +
bf(understanding ~ experience_participant + experience_conducting + trust_benevolence + perceived_risk +
dwell_time + reading_engagement,
family = student()) +
set_rescor(TRUE),
chains = 4, iter = 4000, cores = 4, control = list(adapt_delta = 0.95)
)
library(brms)
library(dplyr)
# Mediationsmodell fitten
fit_mediation <- brm(
data = mydata,
formula =
bf(dwell_time ~ experience_participant + experience_conducting + trust_benevolence + perceived_risk,
family = student()) +
bf(reading_engagement ~ experience_participant + experience_conducting + trust_benevolence + perceived_risk,
family = student()) +
bf(understanding ~ experience_participant + experience_conducting + trust_benevolence + perceived_risk +
dwell_time + reading_engagement,
family = student()) +
set_rescor(TRUE),
chains = 4, iter = 4000, cores = 4, control = list(adapt_delta = 0.95)
)
# Posterior-Daten extrahieren
posterior <- as_draws_df(fit_mediation)
# Indirekte Effekte über dwell time
indirect_dwell <- posterior$b_dwell_time_experience_participant * posterior$b_understanding_dwell_time +
posterior$b_dwell_time_experience_conducting * posterior$b_understanding_dwell_time +
posterior$b_dwell_time_trust_benevolence * posterior$b_understanding_dwell_time +
posterior$b_dwell_time_perceived_risk * posterior$b_understanding_dwell_time
indirect_dwell
# Indirekte Effekte über dwell time
indirect_dwell <- posterior$b_dwelltime_experience_participant * posterior$b_understanding_dwell_time +
posterior$b_dwelltime_experience_conducting * posterior$b_understanding_dwell_time +
posterior$b_dwelltime_trust_benevolence * posterior$b_understanding_dwell_time +
posterior$b_dwelltime_perceived_risk * posterior$b_understanding_dwell_time
indirect_dwell
quantile(indirect_dwell, c(0.025, 0.975))
mean(indirect_dwell)
# Indirekte Effekte über reading engagement
indirect_engagement <- posterior$b_readingengagement_experience_participant * posterior$b_understanding_reading_engagement +
posterior$b_readingengagement_experience_conducting * posterior$b_understanding_reading_engagement +
posterior$b_readingengagement_trust_benevolence * posterior$b_understanding_reading_engagement +
posterior$b_readingengagement_perceived_risk * posterior$b_understanding_reading_engagement
quantile(indirect_engagement, c(0.025, 0.975))
mean(indirect_engagement)
# Gesamte indirekte Effekte
indirect_total <- indirect_dwell + indirect_engagement
quantile(indirect_total, c(0.025, 0.975))
mean(indirect_total)
# Residualkorrelationen der Mediatoren
rescor_summary <- posterior %>%
select(starts_with("rescor")) %>%
summarise(across(everything(), list(mean = mean, CI_low = ~quantile(., 0.025), CI_high = ~quantile(., 0.975))))
rescor_summary
n <- 330  # gewünschte Stichprobengröße
# Plausible Mittelwerte / Standardabweichungen
experience_participant <- rnorm(n, 0, 1)
experience_conducting <- rnorm(n, 0, 1)
trust_benevolence <- rnorm(n, 0, 1)
perceived_risk <- rnorm(n, 0, 1)
# Mediatoren simulieren (Dummy-Effekte als Beispiel)
dwell_time <- rgamma(n, shape = 2, scale = exp(
0.1*experience_participant + 0.05*experience_conducting - 0.1*trust_benevolence + 0.1*perceived_risk
))
reading_engagement <- rnorm(n, mean = 50 -
2*experience_participant - 1.5*experience_conducting - 2*trust_benevolence + 2*perceived_risk, sd = 10)
# Outcome simulieren
understanding <- rnorm(n, mean = 80 -
1*dwell_time - 0.5*reading_engagement +
1*experience_participant - 0.5*trust_benevolence + 0.5*perceived_risk, sd = 15)
mydata <- data.frame(
experience_participant,
experience_conducting,
trust_benevolence,
perceived_risk,
dwell_time,
reading_engagement,
understanding
)
library(brms)
library(dplyr)
# Mediationsmodell fitten
fit_mediation <- brm(
data = mydata,
formula =
bf(dwell_time ~ experience_participant + experience_conducting + trust_benevolence + perceived_risk,
family = student()) +
bf(reading_engagement ~ experience_participant + experience_conducting + trust_benevolence + perceived_risk,
family = student()) +
bf(understanding ~ experience_participant + experience_conducting + trust_benevolence + perceived_risk +
dwell_time + reading_engagement,
family = student()) +
set_rescor(TRUE),
chains = 4, iter = 4000, cores = 4, control = list(adapt_delta = 0.95)
)
# Posterior-Daten extrahieren
posterior <- as_draws_df(fit_mediation)
# Indirekte Effekte über dwell time
indirect_dwell <- posterior$b_dwelltime_experience_participant * posterior$b_understanding_dwell_time +
posterior$b_dwelltime_experience_conducting * posterior$b_understanding_dwell_time +
posterior$b_dwelltime_trust_benevolence * posterior$b_understanding_dwell_time +
posterior$b_dwelltime_perceived_risk * posterior$b_understanding_dwell_time
quantile(indirect_dwell, c(0.025, 0.975))
mean(indirect_dwell)
# Indirekte Effekte über reading engagement
indirect_engagement <- posterior$b_readingengagement_experience_participant * posterior$b_understanding_reading_engagement +
posterior$b_readingengagement_experience_conducting * posterior$b_understanding_reading_engagement +
posterior$b_readingengagement_trust_benevolence * posterior$b_understanding_reading_engagement +
posterior$b_readingengagement_perceived_risk * posterior$b_understanding_reading_engagement
quantile(indirect_engagement, c(0.025, 0.975))
mean(indirect_engagement)
# Gesamte indirekte Effekte
indirect_total <- indirect_dwell + indirect_engagement
quantile(indirect_total, c(0.025, 0.975))
mean(indirect_total)
# Residualkorrelationen der Mediatoren
rescor_summary <- posterior %>%
select(starts_with("rescor")) %>%
summarise(across(everything(), list(mean = mean, CI_low = ~quantile(., 0.025), CI_high = ~quantile(., 0.975))))
rescor_summary
grViz("
digraph MANOVA {
graph [layout = dot, rankdir = LR, ranksep=3.0, nodesep=0.6]
# Knotenstil: manifeste Variablen
node [shape=rectangle, style=filled, fillcolor=White]
# Manifeste Prädiktoren
Exp_Participant [label = 'Experience as\\nResearch Participant']
Exp_Conducting [label = 'Experience\\nConducting Studies']
# Manifeste AV
DwellTime [label = 'Dwell Time']
# Latente Variablen (andere Form)
node [shape=ellipse, style=filled, fillcolor=White]
# Latente Prädiktoren
Trust [label = 'Perceived Trust\\n(Benevolence)']
Risk [label = 'Perceived Risk\\nof Participation']
# Latente AVs
ReadingEngagement [label = 'Reading\\nEngagement']
Understanding [label = 'Understanding']
{rank=same; Exp_Participant; Exp_Conducting; Trust; Risk}
{rank=same; DwellTime; ReadingEngagement}
{rank=same; Understanding}
# Kanten: Jeder Prädiktor auf jede AV
Exp_Participant:e -> DwellTime:w
Exp_Participant:e -> ReadingEngagement:w
Exp_Conducting:e -> DwellTime:w
Exp_Conducting:e -> ReadingEngagement:w
Trust:e -> DwellTime:w
Trust:e -> ReadingEngagement:w
Risk:e -> DwellTime:w
Risk:e -> ReadingEngagement:w
DwellTime:e -> Understanding:w
ReadingEngagement:e -> Understanding:w
# Korrelationen (bidirektionale Pfeile) zwischen den AVs
edge [dir=both]
DwellTime:n -> ReadingEngagement:s
ReadingEngagement:s -> DwellTime:n
}
")
rescor_summary
rescor_summary[1]
rescor_summary[2]
rescor_summary[3]
rescor_summary[4]
log(0)
study1_sample_data <- data.frame(study = c(rep("A", 55), rep("B", 55), rep("C", 55), rep("D", 55)),
words_per_minute = c(c(rbeta(n = 50, shape1 = 5, shape2 = 1.5) * 3600, rnorm(5, 250, 50)),
c(rbeta(n = 50, shape1 = 5, shape2 = 1.5) * 4100, rnorm(5, 250, 50)),
c(rbeta(n = 50, shape1 = 5, shape2 = 1.5) * 5400, rnorm(5, 250, 50)),
c(rbeta(n = 50, shape1 = 5, shape2 = 1.5) * 4200, rnorm(5, 250, 50))
)
ggplot() +
geom_rect(aes(ymin= 40,
ymax = 600,
xmin = -Inf,
xmax = Inf),
fill = 'grey', alpha = 0.40, color = NA) +
geom_rect(aes(ymin= 600,
ymax = 900,
xmin = -Inf,
xmax = Inf),
fill = 'yellow', alpha = 0.40, color = NA) +
geom_rect(aes(ymin= 900,
ymax = Inf,
xmin = -Inf,
xmax = Inf),
fill = 'red', alpha = 0.20, color = NA) +
geom_jitter(data=study1_sample_data, aes(x=study, y=words_per_minute, colour = study), width = .25, size = 3) +
scale_y_continuous(limits = c(0, 5500), expand = c(0,0), breaks = c(40, 600, 900, 2000, 3000, 4000, 5000)) +
ggtitle("Artificial data", subtitle = "for illustration of data analysis") +
scale_color_viridis_d(end = .85) +
theme_light() +
theme(panel.grid.minor = element_blank(),
legend.position = "none",
text = element_text(size = 20))
library(fontawesome)
library(ggplot2)
library(lavaan)
# library(lavaanPlot)
library(DiagrammeR)
library(tidyverse)
study1_sample_data <- data.frame(study = c(rep("A", 55), rep("B", 55), rep("C", 55), rep("D", 55)),
words_per_minute = c(c(rbeta(n = 50, shape1 = 5, shape2 = 1.5) * 3600, rnorm(5, 250, 50)),
c(rbeta(n = 50, shape1 = 5, shape2 = 1.5) * 4100, rnorm(5, 250, 50)),
c(rbeta(n = 50, shape1 = 5, shape2 = 1.5) * 5400, rnorm(5, 250, 50)),
c(rbeta(n = 50, shape1 = 5, shape2 = 1.5) * 4200, rnorm(5, 250, 50))
)
ggplot() +
geom_rect(aes(ymin= 40,
ymax = 600,
xmin = -Inf,
xmax = Inf),
fill = 'grey', alpha = 0.40, color = NA) +
geom_rect(aes(ymin= 600,
ymax = 900,
xmin = -Inf,
xmax = Inf),
fill = 'yellow', alpha = 0.40, color = NA) +
geom_rect(aes(ymin= 900,
ymax = Inf,
xmin = -Inf,
xmax = Inf),
fill = 'red', alpha = 0.20, color = NA) +
geom_jitter(data=study1_sample_data, aes(x=study, y=words_per_minute, colour = study), width = .25, size = 3) +
scale_y_continuous(limits = c(0, 5500), expand = c(0,0), breaks = c(40, 600, 900, 2000, 3000, 4000, 5000)) +
ggtitle("Artificial data", subtitle = "for illustration of data analysis") +
scale_color_viridis_d(end = .85) +
theme_light() +
theme(panel.grid.minor = element_blank(),
legend.position = "none",
text = element_text(size = 20))
# Daten werden je nach Sprache zentriert (silent reading speed)
data <- data %>%
mutate(words_per_minute_centered = case_when(
language == "German"  ~ words_per_minute - 260,
language == "English" ~ words_per_minute - 238
))
